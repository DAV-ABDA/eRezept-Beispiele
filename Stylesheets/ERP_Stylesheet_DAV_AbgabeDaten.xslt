<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="1.0"                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"                xmlns:fhir="http://hl7.org/fhir"                xmlns:xhtml="http://www.w3.org/1999/xhtml"                xmlns="http://www.w3.org/1999/xhtml"                exclude-result-prefixes="fhir xhtml">    <!-- Ersteller: (ABDA/DAV) fhir@abda.de -->    <xsl:output method="html" encoding="UTF-8" indent="yes" omit-xml-declaration="yes"/>    <xsl:template match="/">        <xsl:text disable-output-escaping='yes'>&lt;!DOCTYPE html&gt;</xsl:text>        <html lang="de">            <head>                <meta charset="UTF-8"/>                <meta name="viewport" content="width=device-width, initial-scale=1.0"/>                <meta name="author" content="ABDA/DAV"/>                <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB71BMVEUAAAD//Pz50tX////97vD/+/z97e774OL73eD73uDscHzdAA3bAADaAADjKjv509f98/TmP0786evoTVv62dz////3vsPtdYDpWGXwiZP98vP////1r7XsbHjlOUnhFSjiIjTqX2z1sLf////////ugIrkMkLlOEjvg43////pVmTjKDrgDyPmQlH74uTpVmPvgozrYm/hFyrmO0v73d/pWWftdoH2trzjKjvmPEv73eD2t73wj5nscHvtd4LvhI7jJDbueoTtcn7xk5zpVWPkLj/lNEXmPk7hFSjmPEv62Nvzo6vrYm7lOUnugIv3wMXjKjvhGSvqXGn1rrX74uXue4bkL0Dtd4L1tbvjKDnhGSvvhY/2t73mQVHlM0TymKD50NToTVzmQlL3wMX6297ymKHqXmzkLj/nSVfynKT2vcPrZXHiIjTjJTfwjJb////0qrHsanbsbXn3wMX++/vwiJLvg4397u/fCR3gESTfBxvfBxzgDiLfCBzfDSDfBhvgEiXkMEDnQ1LlN0fnR1bjJDbqWmjkM0PufYfwjpfufIbvgozqXWrhGy3fCx/gEybnRFP1srj2vcPufonjKzzgDyLeBBjjKTvsb3rhGi3eBBnkLj/tc37iHTDlOEjpVmTiHjDfDCDhFSjgECP///95m2A4AAAAeHRSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAADLpHYcg0GN5Lg/veqMgECgu/kcAW0+/7cG7Sfqv3dHLNwNPLdHDRu06+N+H9/a/H76uD94iRY5Px/RvP8sDkNcutxM/L+mm7t7lEfzdQrEUup7c1LJZ/2914IRK+tJwp0nwwtze6SAAAAAWJLR0QDEQxM8gAAAAd0SU1FB+gKAgoaARzHrP4AAAD1SURBVBjTY2AAAUZRMXEJSSkmZjCPmUVaRlZOvkJBUUmZFSygoqpWWVVVUV2jriHNBhLQ1KqtrdPWqa2o19VjBwvoV9Q2GBga1VYZm3CABUwbm5rNzC2qqiytOBkYuKxtbFta2+zsHaAC3I7tHZ1d3T29fRUQAR6n/gkTJ02eUlsBFeB1mjpt+oyZs6pqoQJ8zi6us+fMdXP3qK3y9OJnEFDx9vGdN3+Bn39AVW1gUDBDSGhYbdXCmkXhEZFVFVVR0QwxsX1VFbUVcfEJiZXVFUnJDCmpaemL+zMyRQWzsnNy83gZmIXyCwqLioWZmUVKSsvK2QFueUtyDUTGcgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyNC0xMC0wMlQxMDoyNjowMSswMDowMNzwyJMAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjQtMTAtMDJUMTA6MjY6MDErMDA6MDCtrXAvAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC"/>                <style>                    <xsl:text disable-output-escaping='yes'>                        @charset "UTF-8";                        /*!                        * Bootstrap  v5.3.0 (https://getbootstrap.com/)                        * Copyright 2011-2023 The Bootstrap Authors                        * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)                        */                        :root {                            --bs-blue: #0d6efd;                            --bs-indigo: #6610f2;                            --bs-purple: #6f42c1;                            --bs-pink: #d63384;                            --bs-red: #dc3545;                            --bs-orange: #fd7e14;                            --bs-yellow: #ffc107;                            --bs-green: #198754;                            --bs-teal: #20c997;                            --bs-cyan: #0dcaf0;                            --bs-black: #000;                            --bs-white: #fff;                            --bs-gray: #6c757d;                            --bs-gray-dark: #343a40;                            --bs-gray-100: #f8f9fa;                            --bs-gray-200: #e9ecef;                            --bs-gray-300: #dee2e6;                            --bs-gray-400: #ced4da;                            --bs-gray-500: #adb5bd;                            --bs-gray-600: #6c757d;                            --bs-gray-700: #495057;                            --bs-gray-800: #343a40;                            --bs-gray-900: #212529;                            --bs-primary: #0d6efd;                            --bs-secondary: #6c757d;                            --bs-success: #198754;                            --bs-info: #0dcaf0;                            --bs-warning: #ffc107;                            --bs-danger: #dc3545;                            --bs-light: #f8f9fa;                            --bs-dark: #212529;                            --bs-primary-rgb: 13, 110, 253;                            --bs-secondary-rgb: 108, 117, 125;                            --bs-success-rgb: 25, 135, 84;                            --bs-info-rgb: 13, 202, 240;                            --bs-warning-rgb: 255, 193, 7;                            --bs-danger-rgb: 220, 53, 69;                            --bs-light-rgb: 248, 249, 250;                            --bs-dark-rgb: 33, 37, 41;                            --bs-primary-text-emphasis: #052c65;                            --bs-secondary-text-emphasis: #2b2f32;                            --bs-success-text-emphasis: #0a3622;                            --bs-info-text-emphasis: #055160;                            --bs-warning-text-emphasis: #664d03;                            --bs-danger-text-emphasis: #58151c;                            --bs-light-text-emphasis: #495057;                            --bs-dark-text-emphasis: #495057;                            --bs-primary-bg-subtle: #cfe2ff;                            --bs-secondary-bg-subtle: #e2e3e5;                            --bs-success-bg-subtle: #d1e7dd;                            --bs-info-bg-subtle: #cff4fc;                            --bs-warning-bg-subtle: #fff3cd;                            --bs-danger-bg-subtle: #f8d7da;                            --bs-light-bg-subtle: #fcfcfd;                            --bs-dark-bg-subtle: #ced4da;                            --bs-primary-border-subtle: #9ec5fe;                            --bs-secondary-border-subtle: #c4c8cb;                            --bs-success-border-subtle: #a3cfbb;                            --bs-info-border-subtle: #9eeaf9;                            --bs-warning-border-subtle: #ffe69c;                            --bs-danger-border-subtle: #f1aeb5;                            --bs-light-border-subtle: #e9ecef;                            --bs-dark-border-subtle: #adb5bd;                            --bs-white-rgb: 255, 255, 255;                            --bs-black-rgb: 0, 0, 0;                            --bs-font-sans-serif: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", "Noto Sans", "Liberation Sans", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";                            --bs-font-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;                            --bs-gradient: linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0));                            --bs-body-font-family: var(--bs-font-sans-serif);                            --bs-body-font-size: 1rem;                            --bs-body-font-weight: 400;                            --bs-body-line-height: 1.5;                            --bs-body-color: #212529;                            --bs-body-color-rgb: 33, 37, 41;                            --bs-body-bg: #fff;                            --bs-body-bg-rgb: 255, 255, 255;                            --bs-emphasis-color: #000;                            --bs-emphasis-color-rgb: 0, 0, 0;                            --bs-secondary-color: rgba(33, 37, 41, 0.75);                            --bs-secondary-color-rgb: 33, 37, 41;                            --bs-secondary-bg: #e9ecef;                            --bs-secondary-bg-rgb: 233, 236, 239;                            --bs-tertiary-color: rgba(33, 37, 41, 0.5);                            --bs-tertiary-color-rgb: 33, 37, 41;                            --bs-tertiary-bg: #f8f9fa;                            --bs-tertiary-bg-rgb: 248, 249, 250;                            --bs-heading-color: inherit;                            --bs-link-color: #0d6efd;                            --bs-link-color-rgb: 13, 110, 253;                            --bs-link-decoration: underline;                            --bs-link-hover-color: #0a58ca;                            --bs-link-hover-color-rgb: 10, 88, 202;                            --bs-code-color: #d63384;                            --bs-highlight-bg: #fff3cd;                            --bs-border-width: 1px;                            --bs-border-style: solid;                            --bs-border-color: #dee2e6;                            --bs-border-color-translucent: rgba(0, 0, 0, 0.175);                            --bs-border-radius: 0.375rem;                            --bs-border-radius-sm: 0.25rem;                            --bs-border-radius-lg: 0.5rem;                            --bs-border-radius-xl: 1rem;                            --bs-border-radius-xxl: 2rem;                            --bs-border-radius-2xl: var(--bs-border-radius-xxl);                            --bs-border-radius-pill: 50rem;                            --bs-box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);                            --bs-box-shadow-sm: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);                            --bs-box-shadow-lg: 0 1rem 3rem rgba(0, 0, 0, 0.175);                            --bs-box-shadow-inset: inset 0 1px 2px rgba(0, 0, 0, 0.075);                            --bs-focus-ring-width: 0.25rem;                            --bs-focus-ring-opacity: 0.25;                            --bs-focus-ring-color: rgba(13, 110, 253, 0.25);                            --bs-form-valid-color: #198754;                            --bs-form-valid-border-color: #198754;                            --bs-form-invalid-color: #dc3545;                            --bs-form-invalid-border-color: #dc3545                        }                        *,                        ::after,                        ::before {                        box-sizing: border-box                        }                        @media (prefers-reduced-motion:no-preference) {                            :root {                                scroll-behavior: smooth                            }                        }                        body {                            margin: 0;                            font-family: var(--bs-body-font-family);                            font-size: var(--bs-body-font-size);                            font-weight: var(--bs-body-font-weight);                            line-height: var(--bs-body-line-height);                            color: var(--bs-body-color);                            text-align: var(--bs-body-text-align);                            background-color: var(--bs-body-bg);                            -webkit-text-size-adjust: 100%;                            -webkit-tap-highlight-color: transparent                        }                        hr {                            margin: 1rem 0;                            color: inherit;                            border: 0;                            border-top: var(--bs-border-width) solid;                            opacity: .25                        }                        .h1,                        .h4,                        h1,                        h4 {                            margin-top: 0;                            margin-bottom: .5rem;                            font-weight: 500;                            line-height: 1.2;                            color: var(--bs-heading-color)                        }                        .h1,                        h1 {                            font-size: calc(1.375rem + 1.5vw)                        }                        @media (min-width:1200px) {                        .h1,                        h1 {                            font-size: 2.5rem                        }                        }                        .h4,                        h4 {                            font-size: calc(1.275rem + .3vw)                        }                        @media (min-width:1200px) {                        .h4,                            h4 {                                font-size: 1.5rem                            }                        }                        label {                            display: inline-block                        }                        input,                        textarea {                            margin: 0;                            font-family: inherit;                            font-size: inherit;                            line-height: inherit                        }                        ::-moz-focus-inner {                            padding: 0;                            border-style: none                        }                        textarea {                            resize: vertical                        }                        ::-webkit-datetime-edit-day-field,                        ::-webkit-datetime-edit-fields-wrapper,                        ::-webkit-datetime-edit-hour-field,                        ::-webkit-datetime-edit-minute,                        ::-webkit-datetime-edit-month-field,                        ::-webkit-datetime-edit-text,                        ::-webkit-datetime-edit-year-field {                        padding: 0                        }                        ::-webkit-inner-spin-button {                        height: auto                        }                        ::-webkit-search-decoration {                        -webkit-appearance: none                        }                        ::-webkit-color-swatch-wrapper {                        padding: 0                        }                        ::-webkit-file-upload-button {                        font: inherit;                        -webkit-appearance: button                        }                        ::file-selector-button {                        font: inherit;                        -webkit-appearance: button                        }                        :root {                            --bs-breakpoint-xs: 0;                            --bs-breakpoint-sm: 576px;                            --bs-breakpoint-md: 768px;                            --bs-breakpoint-lg: 992px;                            --bs-breakpoint-xl: 1200px;                            --bs-breakpoint-xxl: 1400px                        }                        .row {                            --bs-gutter-x: 1.5rem;                            --bs-gutter-y: 0;                            display: flex;                            flex-wrap: wrap;                            margin-top: calc(-1 * var(--bs-gutter-y));                            margin-right: calc(-.5 * var(--bs-gutter-x));                            margin-left: calc(-.5 * var(--bs-gutter-x))                        }                        .row>* {                            flex-shrink: 0;                            width: 100%;                            max-width: 100%;                            padding-right: calc(var(--bs-gutter-x) * .5);                            padding-left: calc(var(--bs-gutter-x) * .5);                            margin-top: var(--bs-gutter-y)                        }                        .col-1 {                            flex: 0 0 auto;                            width: 8.33333333%                        }                        .col-2 {                        flex: 0 0 auto;                        width: 16.66666667%                        }                        .col-3 {                        flex: 0 0 auto;                        width: 25%                        }                        .col-4 {                        flex: 0 0 auto;                        width: 33.33333333%                        }                        .col-5 {                        flex: 0 0 auto;                        width: 41.66666667%                        }                        .col-6 {                        flex: 0 0 auto;                        width: 50%                        }                        .col-7 {                        flex: 0 0 auto;                        width: 58.33333333%                        }                        .col-8 {                        flex: 0 0 auto;                        width: 66.66666667%                        }                        .col-9 {                        flex: 0 0 auto;                        width: 75%                        }                        .col-10 {                        flex: 0 0 auto;                        width: 83.33333333%                        }                        .col-12 {                        flex: 0 0 auto;                        width: 100%                        }                        .g-0 {                        --bs-gutter-x: 0                        }                        .g-0 {                        --bs-gutter-y: 0                        }                        .g-1 {                        --bs-gutter-x: 0.25rem                        }                        .g-1 {                        --bs-gutter-y: 0.25rem                        }                        @media (min-width:768px) {                        .col-md-6 {                        flex: 0 0 auto;                        width: 50%                        }                        }                        @keyframes progress-bar-stripes {                        0% {                        background-position-x: 1rem                        }                        }                        @keyframes spinner-border {                        to {                        transform: rotate(360deg)                        }                        }                        @keyframes spinner-grow {                        0% {                        transform: scale(0)                        }                        50% {                        opacity: 1;                        transform: none                        }                        }                        .placeholder {                        display: inline-block;                        min-height: 1em;                        vertical-align: middle;                        cursor: wait;                        background-color: currentcolor;                        opacity: .5                        }                        @keyframes placeholder-glow {                        50% {                        opacity: .2                        }                        }                        @keyframes placeholder-wave {                        100% {                        -webkit-mask-position: -200% 0%;                        mask-position: -200% 0%                        }                        }                        .border-1 {                        border-width: 1px !important                        }                        /* Bootstrap Ende */                    </xsl:text>                </style>                <style>                    /* Internes Stylesheet */                    /* Globale Variablen */                    :root{                    --background-color-ges: #d8c5ff;                    --border-background-color-ges: #AA7EDD;                    --text-color-ges: #290058;                    --border-color-dark: #423055;                    --background-stripes-color: #e9e9e9;                    --outter-div-bg-color: #ffffff;                    --background-color-int: var(--border-background-color-ges);                    --border-background-color-int: var(--border-background-color-ges);                    }                    body {                    width: 210mm;                    max-width: 210mm;                    min-width: 210mm;                    height: 297mm;                    max-height: 297mm;                    min-height: 297mm;                    left:0;                    top: 0;                    margin: 0px;                    padding: 5mm;                    font-size: 12px;                    font-family: Arial, sans-serif;                    background: repeating-linear-gradient(                    135deg,                    var(--background-stripes-color),                    var(--background-stripes-color) 10px,                    transparent 10px,                    transparent 20px                    );                    }                    .background-container-ges{                    background-color: var(--background-color-ges);                    border: 1px solid var(--border-background-color-ges);                    color: var(--text-color-ges);                    }                    h1{                    font-size: large;                    font-weight: bold;                    }                    h4{                    margin-top: 2mm;                    color:var(--text-color-ges);                    font-size: medium;                    font-weight: bold;                    padding-bottom: 0px;                    margin-bottom: 0px;                    }                    input{                    border: 1px solid c3c3c3;                    outline: none;                    }                    input:hover{                    border: 1px solid c3c3c3;                    outline: none;                    }                    input:focus{                    border: 1px solid c3c3c3;                    outline: none;                    }                    input:hover{                    outline: none;                    }                    .input-container {                    position: relative;                    display: inline-block;                    width: 100%;                    }                    .input-container label {                    position: absolute;                    top: -0px;                    left: 0px;                    padding: 0 5px;                    font-size: 10px;                    }                    .fieldset {                    border: 1px solid var(--text-color-ges);                    padding-top: 8px;                    padding-left: 10px;                    height: 10mm;                    width: 100%;                    text-align: left;                    background-color: var(--background-color-int);                    }                    .text-input{                    font-family: Consolas, sans-serif;                    height: 10mm;                    width: 100%;                    text-align: left;                    border: 1px solid var(--text-color-ges);                    box-shadow: none;                    appearance: none;                    outline: none;                    background-color: var(--background-color-ges);                    padding-top: 8px;                    padding-left: 10px;                    }                    .placeholder{                    width: 100%;                    height: 10mm;                    padding-top: 8px;                    border: 1px solid rgba(0, 0, 0, 0);                    background-color: var(--border-background-color-ges);                    }                    .intern-container{                    background-color: var(--background-color-int);                    padding:2mm;                    }                    .row{                    padding-top: 0px;                    padding-bottom: 3px;                    }                    #txt-area{                    overflow: hidden;                    resize: none;                    line-height: 0.8;                    padding-top: 15px;                    }                    .container{                    width: 297mm;                    max-width: 297mm;                    min-width: 297mm;                    }                    hr{                    margin-top: 1mm;                    margin-bottom: 1mm;                    background-color: var(--text-color-ges);                    }                    .container, .container-fluid {                    width: 100% !important;                    max-width: none !important;                    }                    .col, .col-*, .row {                    flex: none !important;                    width: auto !important;                    }                    .checkbox-container {                    display: flex;                    align-items: center;                    flex-direction: row-reverse; /* Position checkbox to the left and label to the right */                    margin-left: 0px;                    }                    .checkbox-container > label {                    margin-left: 4px; /* Adjust spacing between checkbox and label */                    margin-right: 0; /* Remove right margin to ensure consistency */                    font-size: 8px;                    width:100%;                    }                    /* Hide the default checkbox */                    input[type="checkbox"] {                    margin-left: 3px;                    accent-color: var(--text-color-ges);                    border: 1px solid var(--text-color-ges);                    outline: var(--text-color-ges);                    -webkit-appearance: none;                    -moz-appearance: none;                    appearance: none; /* Removes default styling */                    width: 15px;                    min-width: 15px;                    height: 15px;                    border: 1px solid var(--text-color-ges); /* Default border color */                    background-color: var(--background-color-ges); /* Default background color */                    cursor: pointer;                    }                    /* Change the background color when checked */                    input[type="checkbox"]:checked {                    background-color: var(--background-color-ges); /* Green when checked */                    border-color: var(--text-color-ges); /* Green border when checked */                    }                    /* Add a checkmark */                    input[type="checkbox"]:checked::before {                    content: "x";                    display: block;                    text-align: center;                    font-size: 16px;                    line-height: 11px; /* Align the checkmark vertically */                    top: -10px;                    width: 15px;                    height: 15px;                    min-width: 15px;                    margin-left: -1px;                    }                    .row {                    display: flex;                    align-items: center;                    justify-content: flex-start; /* Aligns all checkboxes to the left edge */                    }                    .outter-div {                    background-color: var(--outter-div-bg-color);                    overflow: hidden;                    width: 210mm;                    max-width: 210mm;                    min-width: 210mm;                    height: 297mm;                    max-height: 297mm;                    min-height: 297mm;                    padding:5mm;                    }                    .col-1-5{                    flex: 0 0 auto;                    width: 12.49%;                    }                    .col-2-5{                    flex: 0 0 auto;                    width: 20.8333333333333%;                    }                    @media print {                    @page {                    size: A4;                    margin: 0;                    }                    body {                    margin: 0;                    padding: 0;                    }                    }                    .width-100{ width: 100%; }                    .padding-1{ padding: 0.5%; }                    .border-l{ border-left: 0px solid var(--border-color-dark); }                    .height-15mm{ height: 15mm; }                    .height-18mm{ height: 18mm; }                    .padding-bot-2{ padding-bottom: 2mm; }                    .vertical-align{ margin-top: 10px; }                    .padding-top-bot-0{ padding-top: 0px; padding-bottom: 0px; }                    .margin-top-minus-6px{ margin-top: -6px; }                    .margin-left-min-2{ margin-left: -2px; }                    .margin-right-min-2{ margin-right: -2px; }                    .margin-top-min-5{ margin-top: -5px; }                    .margin-top-min-6{ margin-top: -6px; }                    .margin-top-5{ margin-top: 5px; }                    .margin-top-min-1{ margin-top: -1px; }                    .text-align-right{ text-align: right; }                    .no-bottom-border{ border-bottom: none0; }                    .border-dotted-t{ border-top: 1px dotted var(--border-color-dark); }                    .border-right-none{ border-right: none; }                    .border-dotted-t-l{                    border-top: 1px dotted var(--border-color-dark);                    border-left: 1px dotted var(--border-color-dark);                    }                    .border-left{                    border: 1px solid var(--border-color-dark);                    border-right: none;                    border-left: 1px dotted var(--border-color-dark);                    }                    .border-right{                    border: 1px solid var(--border-color-dark);                    border-right: 1px dotted var(--border-color-dark);                    border-left: none;                    }                    .border-left-right{                    border: 1px solid var(--border-color-dark);                    border-left: 1px dotted var(--border-color-dark);                    }                    .border-right-left{                    border: 1px solid var(--border-color-dark);                    border-right: none;                    }                    /* Internes Stylesheet Ende */                </style>                <title>DAV Stylesheet Abgabe</title>            </head>            <body>                <xsl:choose>                    <xsl:when test="not(fhir:Bundle)">                        <b>Instanz ist kein Bundle</b>                        <br/>                    </xsl:when>                    <xsl:when test="fhir:Bundle">                        <xsl:choose>                            <xsl:when test="fhir:Bundle/fhir:meta/fhir:profile/@value = 'http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-PR-ERP-AbgabedatenBundle|1.1.0'">                                <xsl:apply-templates select="fhir:Bundle"/>                            </xsl:when>                            <xsl:when test="fhir:Bundle/fhir:meta/fhir:profile/@value = 'http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-PR-ERP-AbgabedatenBundle|1.3'">                                <xsl:apply-templates select="fhir:Bundle"/>                            </xsl:when>                            <xsl:when test="fhir:Bundle/fhir:meta/fhir:profile/@value = 'http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-PR-ERP-AbgabedatenBundle|1.4'">                                <xsl:apply-templates select="fhir:Bundle"/>                            </xsl:when>                            <xsl:when test="fhir:Bundle/fhir:meta/fhir:profile/@value = 'http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-PR-ERP-AbgabedatenBundle|1.5'">                                <xsl:apply-templates select="fhir:Bundle"/>                            </xsl:when>                            <xsl:otherwise>                                <b>!!! ProfileVersion stimmt nicht bzw. wird nicht unterstützt!!!</b>                                <br/>                                Profile+Version: "<xsl:value-of select="fhir:Bundle/fhir:meta/fhir:profile/@value"/>"                            </xsl:otherwise>                        </xsl:choose>                    </xsl:when>                </xsl:choose>            </body>        </html>    </xsl:template>    <xsl:template match="fhir:Bundle[not(ancestor::fhir:Bundle)]">        <h1>Abgabedatensatz</h1>        <xsl:variable name="_rowId">            <xsl:call-template name="getIdFromReference">                <xsl:with-param name="ref" select="/fhir:Bundle/fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Abrechnungszeilen']/fhir:valueReference/fhir:reference/@value"/>            </xsl:call-template>        </xsl:variable> <!--xsl:value-of select="($rowId)"/-->        <div class="background-container-ges outter-div">            <div class="row g-1 intern-container">                <div class="col-md-1 border-1">                    <div class="row g-1">                        <div class="col-3">                            <div class="input-container">                                <label>Rezept ID</label>                                <input type="text" class="text-input" value="{//fhir:Bundle/fhir:identifier/fhir:value/@value}" readonly=""/>                            </div>                        </div>                        <div class="col-3">                            <div class="input-container">                                <label>Abgabedatum</label>                                <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>                                <xsl:call-template name="formatDate">                                    <xsl:with-param name="date" select="fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:whenHandedOver/@value"/>                                </xsl:call-template>                                <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                            </div>                        </div>                        <div class="col-3">                            <div class="input-container">                                <label>Gesamtbetrag</label>                                <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>                                <xsl:value-of select="translate(/fhir:Bundle/fhir:entry/fhir:resource/fhir:Invoice[fhir:id/@value=$_rowId]/fhir:totalGross/fhir:value/@value, '.', ',')"/>                                <xsl:text disable-output-escaping='yes'> </xsl:text>                                <xsl:value-of select="/fhir:Bundle/fhir:entry/fhir:resource/fhir:Invoice[fhir:id/@value=$_rowId]/fhir:totalGross/fhir:currency/@value"/>                                <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                            </div>                        </div>                        <div class="col-3">                            <div class="input-container">                                <label>Gesamtzuzahlung</label>                                <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>                                <xsl:value-of select="translate(/fhir:Bundle/fhir:entry/fhir:resource/fhir:Invoice[fhir:id/@value=$_rowId]/fhir:totalGross/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Gesamtzuzahlung']/fhir:valueMoney/fhir:value/@value, '.', ',')"/>                                <xsl:text disable-output-escaping='yes'> </xsl:text>                                <xsl:value-of select="/fhir:Bundle/fhir:entry/fhir:resource/fhir:Invoice[fhir:id/@value=$_rowId]/fhir:totalGross/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Gesamtzuzahlung']/fhir:valueMoney/fhir:currency/@value"/>                                <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                            </div>                        </div>                    </div>                    <div class="row g-1">                        <div class="col-4">                            <div class="input-container">                                <label>Abgebende Apotheke</label>                                <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:Organization/fhir:name/@value}" readonly=""/>                            </div>                        </div>                        <div class="col-2">                            <div class="input-container">                                <label>IKNR</label>                                <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:Organization/fhir:identifier/fhir:value/@value}" readonly=""/>                            </div>                        </div>                        <xsl:if test="fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Vertragskennzeichen']">                            <div class="col-6">                                <div class="input-container">                                    <label>Vertragskennzeichen</label>                                    <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Vertragskennzeichen']/fhir:valueString/@value}" readonly=""/>                                </div>                            </div>                        </xsl:if>                    </div>                    <div class="row g-1">                        <div class="col-6">                            <div class="input-container">                                <label>Adresse</label>                                <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:Organization/fhir:address/fhir:line/@value}" readonly=""/>                            </div>                        </div>                    </div>                    <div class="row g-1">                        <div class="col-1">                            <div class="input-container">                                <label>PLZ</label>                                <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:Organization/fhir:address/fhir:postalCode/@value}" readonly=""/>                            </div>                        </div>                        <div class="col-4">                            <div class="input-container">                                <label>Ort</label>                                <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:Organization/fhir:address/fhir:city/@value}" readonly=""/>                            </div>                        </div>                        <div class="col-1">                            <div class="input-container">                                <label>Land</label>                                <input type="text" class="text-input" value="{fhir:entry/fhir:resource/fhir:Organization/fhir:address/fhir:country/@value}" readonly=""/>                            </div>                        </div>                    </div>                </div>            </div>            <!-- Dritter Container (100% des Platzes) -->            <div class="intern-container background-container-ges margin-left-min-2 margin-right-min-2 margin-top-min-5">                <div class="row g-1 width-100">                    <div class="col-12">                        <h4>Abrechnungszeilen</h4>                        <xsl:for-each select="/fhir:Bundle/fhir:entry/fhir:resource/fhir:Invoice[fhir:id/@value=$_rowId]/fhir:lineItem">                            <div class="row g-0" style="margin-bottom: 0px; padding-bottom: 0px;">                                <div class="col-1">                                    <div class="input-container">                                        <label>Pos</label>                                        <!--xsl:number format="1 " /><xsl:value-of select="." /-->                                        <input type="text" class="text-input height-18mm border-right-left" value="{fhir:sequence/@value}" readonly=""/>                                    </div>                                </div>                                <div class="col-2" >                                    <div class="input-container">                                        <label>                                            <xsl:variable name="cs" select="fhir:chargeItemCodeableConcept/fhir:coding/fhir:system/@value"/>                                            <xsl:choose>                                                <xsl:when test="$cs='http://fhir.de/CodeSystem/ifa/pzn'">PZN</xsl:when>                                                <xsl:when test="$cs='http://TA1.abda.de'">SKZ</xsl:when>                                                <xsl:when test="$cs='http://fhir.de/sid/gkv/hmnr'">HMNR</xsl:when>                                                <xsl:when test="$cs='http://fhir.de/NamingSystem/gkv/hmnr'">HMNR</xsl:when>                                            </xsl:choose>                                        </label>                                        <input type="text" class="text-input height-18mm border-right-left" value="{fhir:chargeItemCodeableConcept/fhir:coding/fhir:code/@value}" readonly=""/>                                    </div>                                </div>                                <div class="col-1">                                    <div class="input-container">                                        <label>Faktor</label>                                        <input type="text" class="text-input height-18mm border-right-left" value="{fhir:priceComponent/fhir:factor/@value}" readonly=""/>                                    </div>                                </div>                                <div class="col-1">                                    <div class="input-container">                                        <label>MwSt</label>                                        <!--xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input height-18mm border-right-left&#34; value=&#34;</xsl:text>                                        <xsl:value-of select="translate(fhir:priceComponent/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-MwStSatz']/fhir:valueDecimal/@value, '.', ',')"/>                                        <xsl:text disable-output-escaping='yes'> %&#34; readonly/&gt;</xsl:text-->                                        <input type="text" class="text-input height-18mm border-right-left" value="{translate(fhir:priceComponent/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-MwStSatz']/fhir:valueDecimal/@value, '.', ',')}" readonly=""/>                                    </div>                                </div>                                <div class="col-2 no-bottom-border">                                    <div class="input-container">                                        <label>Ges.Brutto</label>                                        <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input height-18mm border-right-left&#34; value=&#34;</xsl:text>                                        <xsl:value-of select="translate(fhir:priceComponent/fhir:amount/fhir:value/@value, '.', ',')"/>                                        <xsl:text disable-output-escaping='yes'> </xsl:text>                                        <xsl:value-of select="fhir:priceComponent/fhir:amount/fhir:currency/@value"/>                                        <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                                    </div>                                </div>                                <div class="col-5 margin-top-5">                                    <div class="input-container">                                        <label>Kosten Versicherter</label>                                        <!--xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input height-18mm border-right-left&#34; value=&#34;</xsl:text-->                                        <textarea type="text" class="text-input height-18mm border-dotted-t-l" readonly="">                                            <xsl:for-each select="fhir:priceComponent/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-KostenVersicherter']">                                                <xsl:variable name="kategorie" select="fhir:extension[@url='Kategorie']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>                                                <xsl:choose>                                                    <xsl:when test="$kategorie='0'">Zuzahlung (</xsl:when>                                                    <xsl:when test="$kategorie='1'">Mehrkosten (</xsl:when> <!-- Mehrkosten (Apothekenverkaufspreis minus Festbetrag) -->                                                    <xsl:when test="$kategorie='2'">Eigenbeteiligung KB (</xsl:when> <!-- Eigenbeteiligung des Versicherten bei Verordnungen im Rahmen der künstlichen Befruchtung -->                                                </xsl:choose>                                                <xsl:value-of select="($kategorie)"/>                                                <xsl:text disable-output-escaping='yes'>):  </xsl:text>                                                <xsl:value-of select="translate(fhir:extension[@url='Kostenbetrag']/fhir:valueMoney/fhir:value/@value, '.', ',')"/>                                                <xsl:text disable-output-escaping='yes'> </xsl:text>                                                <xsl:value-of select="fhir:extension[@url='Kostenbetrag']/fhir:valueMoney/fhir:currency/@value"/>                                                <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>                                            </xsl:for-each>                                            <!--xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text-->                                        </textarea>                                    </div>                                </div>                            </div>                            <xsl:if test="(fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Chargenbezeichnung']) and (fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Zusatzattribute'])">                                <div class="row g-0" style="padding-top: 0px !important; margin-top: -10px !important;">                                    <div class="col-4 margin-top-min-1">                                        <div class="input-container">                                            <label>Chargennummer(n)</label>                                            <textarea type="text" class="text-input height-18mm border-dotted-t-l" rows="auto">                                                <xsl:for-each select="fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Chargenbezeichnung']">                                                    <xsl:value-of select="fhir:valueString/@value"/>                                                    <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>                                                </xsl:for-each>                                            </textarea>                                        </div>                                    </div>                                    <div class="col-8" style="margin-top:4px;">                                        <div class="input-container">                                            <label>Zusatzattribute</label>                                            <textarea type="text" class="text-input height-18mm border-dotted-t-l" rows="auto" readonly="">                                                <xsl:if test="fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Zusatzattribute']">                                                    <xsl:apply-templates select="fhir:extension/fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='1']"/> <!-- Markt -->                                                    <xsl:apply-templates select="fhir:extension/fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='2']"/> <!-- Rabattvertragserfuellung -->                                                    <xsl:apply-templates select="fhir:extension/fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='3']"/> <!-- PreisguenstigesFAM -->                                                    <xsl:apply-templates select="fhir:extension/fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='4']"/> <!-- ImportFAM -->                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='5']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='6']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='7']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='8']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='9']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='10']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='11']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='12']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='13']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='14']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='15']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='16']"/>                                                    <xsl:apply-templates select="fhir:extension/fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='101']"/>                                                </xsl:if>                                            </textarea>                                        </div>                                    </div>                                </div>                            </xsl:if> <!-- End Charge und Zusatzattribute -->                        </xsl:for-each> <!-- Ende lineItem -->                        <!-- Start Zusatzdaten Herstellung-->                        <xsl:if test="fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-ZusatzdatenHerstellung']">                            <xsl:for-each select="fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-ZusatzdatenHerstellung']">                                <h4>Zusatzdaten Herstellung</h4>                                <xsl:variable name="id_zdhs" select="fhir:valueReference/fhir:reference/@value"/>                                <xsl:apply-templates select="/fhir:Bundle/fhir:entry[fhir:fullUrl/@value=$id_zdhs]/fhir:resource/fhir:MedicationDispense" mode="resource"/>                                <!-- ===> mit Zusatzen Einheiten -->                            </xsl:for-each>                            <div class="row g-1">                                <div class="col-12">                                    <div class="input-container">                                        <label>Preiskennzeichen</label>                                        <textarea type="text" class="text-input" readonly="">11	Apothekeneinkaufspreis nach der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)12	Von der Apotheke mit dem pharmazeutischen Unternehmer vereinbarter Preis (Ohne Umsatzsteuer)13	Von der Apotheke tatsächlich geleisteter Einkaufspreis (Ohne Umsatzsteuer)14	Abrechnungspreis nach dem Vertrag über die Preisbildung für Stoffe und Zubereitungen aus Stoffen (§§ 4 und 5 AMPreisV) (Ohne Umsatzsteuer)15	Zwischen Apotheke und Krankenkasse vereinbarter Preis nach § 129 Abs. 5 SGB V (Ohne Umsatzsteuer)16	Vertragspreise auf Grundlage von § 129a SGB V (Ohne Umsatzsteuer)17	Abrechnungspreis, wenn 'Preis 2' nach der Technischen Beschreibung zum Verzeichnis über mg-Preise eingesetzt werden muss (Ohne Umsatzsteuer)21	Abrechnungspreis, wenn Wirkstoff mit Rabattvertrag nach § 130a Abs. 8c SGB V vom Rabattvertragspartner (Anbieter) zum 'Preis 1' nach der Technischen Beschreibung zum Verzeichnis über mg-Preise an die Apotheke abgegeben wird (Ohne Umsatzsteuer)22	Abrechnungspreis, wenn Wirkstoff mit Rabattvertrag nach § 130a Abs. 8c SGB V vom Rabattvertragspartner (Anbieter) zum 'Preis 2' nach der Technischen Beschreibung zum Verzeichnis über mg-Preise an die Apotheke abgegeben wird (Ohne Umsatzsteuer)23	Abrechnungspreis nach dem Vertrag über die Preisbildung für Stoffe und Zubereitungen aus Stoffen (§§ 4 und 5 AMPreisV), wenn rabattbegünstigtes Arzneimittel zum Zeitpunkt der Vorlage der Verordnung nicht lieferbar ist (Ohne Umsatzsteuer)24	Abrechnungspreis nach dem Vertrag über die Preisbildung für Stoffe und Zubereitungen aus Stoffen (§§ 4 und 5 AMPreisV), wenn rabattbegünstigte Arzneimittel aufgrund pharmazeutischer Bedenken nicht abgegeben werden kann (§ 4 Abs. 3 Satz 2 des Rahmenvertrages nach § 129 SGB V) (Ohne Umsatzsteuer)41	bundeseinheitlicher Preis nach § 132e SGB V (Ohne Umsatzsteuer)61	Zuschlag nach § 5 Absatz 3 Nummer 1 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)62	Zuschlag nach § 5 Absatz 3 Nummer 2 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)63	Zuschlag nach § 5 Absatz 3 Nummer 3 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)70	Zuschlag nach § 5 Absatz 1 Nummer 3 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)71	Zuschlag nach § 5 Absatz 6 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)	Zu verwenden, sofern keine Vereinbarung nach dem Vertrag über die Preisbildung für Stoffe und Zubereitungen aus Stoffen (§§ 4 und 5 AMPreisV) über den Zuschlag für parenterale Zubereitungen besteht74	Zuschlag nach dem Vertrag über die Preisbildung für Stoffe und Zubereitungen aus Stoffen (§§ 4 und 5 AMPreisV) (Ohne Umsatzsteuer)	Zu verwenden, sofern eine Vereinbarung nach dem Vertrag über die Preisbildung für Stoffe und Zubereitungen aus Stoffen (§§ 4 und 5 AMPreisV) über den Zuschlag für parenterale Zubereitungen besteht75	Zwischen Apotheke und Krankenkasse vereinbarter Zuschlag nach § 129 Abs. 5 SGB V (Ohne Umsatzsteuer)76	Zuschlag auf Grundlage von § 129a SGB V (Ohne Umsatzsteuer)80	Zuschlag nach § 6 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)	Sofern der Zuschlag ein Bruttobetrag ist, ist der jeweilige Betrag um die Umsatzsteuer zu mindern.81	Zuschlag nach § 7 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)	Sofern der Zuschlag ein Bruttobetrag ist, ist der jeweilige Betrag um die Umsatzsteuer zu mindern.82	Zuschlag nach § 8 der Arzneimittelpreisverordnung (Ohne Umsatzsteuer)83	Zuschlag nach § 129 Absatz 5g SGB V (Ohne Umsatzsteuer)                                        </textarea>                                    </div>                                </div>                            </div>                        </xsl:if> <!-- Ende Zusatzdaten -->                        <xsl:if test="fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:substitution/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Rezeptaenderung']">                            <h4>Rezeptänderung</h4>                            <xsl:for-each select="fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:substitution/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Rezeptaenderung']">                                <div class="row g-1">                                    <div class="col-1">                                        <div class="input-container">                                            <label>RezÄndArt</label>                                            <input type="text" class="text-input" value="{fhir:extension[@url='ArtRezeptaenderung']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value}"/>                                        </div>                                    </div>                                    <xsl:if test="fhir:extension[@url='DokumentationRezeptaenderung']">                                        <div class="col-5">                                            <div class="input-container">                                                <label>Dokumentation</label>                                                <input type="text" class="text-input" value="{fhir:extension[@url='DokumentationRezeptaenderung']/fhir:valueString/@value}"/>                                            </div>                                        </div>                                    </xsl:if>                                    <div class="col-4">                                        <div class="input-container">                                            <label>Rücksprache Arzt</label>                                            <xsl:variable name="ruecksprache" select="fhir:extension[@url='RueckspracheArzt']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>                                            <textarea type="text" class="text-input" rows="auto" readonly="">                                                <!--xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text-->                                                <xsl:choose>                                                    <xsl:when test="$ruecksprache='0'">Rücksprache mit dem Arzt ist erfolgt. (</xsl:when>                                                    <xsl:when test="$ruecksprache='1'">Dringender Fall, Rücksprache mit dem Arzt war nicht möglich. (</xsl:when>                                                    <xsl:when test="$ruecksprache='2'">Keine Rücksprache mit dem Arzt erforderlich. (</xsl:when>                                                </xsl:choose>                                                <xsl:value-of select="($ruecksprache)"/>)                                                <!--xsl:text disable-output-escaping='yes'>)&#34; readonly/&gt;</xsl:text-->                                            </textarea>                                        </div>                                    </div>                                    <div class="col-2">                                        <div class="input-container">                                            <label>Datum</label>                                            <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>                                            <xsl:if test="fhir:extension[@url='DatumRezeptaenderung']">                                                <xsl:call-template name="formatDate">                                                    <xsl:with-param name="date" select="fhir:extension[@url='DatumRezeptaenderung']/fhir:valueDate/@value"/>                                                </xsl:call-template>                                            </xsl:if>                                            <xsl:if test="not(fhir:extension[@url='DatumRezeptaenderung'])">                                                <xsl:call-template name="formatDate">                                                    <xsl:with-param name="date" select="/fhir:Bundle/fhir:entry/fhir:resource/fhir:MedicationDispense[fhir:type/fhir:coding/fhir:code/@value='Abgabeinformationen']/fhir:whenHandedOver/@value"/>                                                </xsl:call-template>                                            </xsl:if>                                            <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                                        </div>                                    </div>                                </div>                            </xsl:for-each> <!-- ENDE Rezeptänderungen -->                            <div class="row g-1">                                <div class="col-12">                                    <div class="input-container">                                        <label>Arten der Rezeptaenderung</label>                                        <textarea type="text" class="text-input" readonly="">1	Abweichung von der Verordnung bzgl. der Darreichungsform bei Fertigarzneimitteln	Begründung: § 2 Abs. 6 AMVV / § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §1292	Korrektur / Ergänzung der Darreichungsform bei Rezepturen	Begründung: § 2 Abs. 6 AMVV / § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §129	Anmerkungen: Dokumentation der Änderung im Feld 'Dokumentation Rezeptänderung' erforderlich3	Korrektur / Ergänzung der Gebrauchsanweisung bei einer Rezeptur	Begründung: § 2 Abs. 6 AMVV / § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §129	Anmerkungen: Dokumentation der Änderung im Feld 'Dokumentation Rezeptänderung' erforderlich4	Korrektur / Ergänzung der Dosierungsanweisung	Begründung: § 2 Abs. 6 AMVV / § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §129	Anmerkungen: Dokumentation der Änderung im Feld 'Dokumentation Rezeptänderung' erforderlich5	Ergänzung eines fehlenden Hinweises auf einen Medikationsplan, der das verschriebene Arzneimittel umfasst, oder auf eine schriftliche Dosierungsanweisung	Begründung: § 2 Abs. 6a AMVV / § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §1296	Abweichung von der Verordnung bzgl. der Bezeichnung des Fertigarzneimittels	Begründung: § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §1297	Abweichung von der Verordnung bzgl. der Bezeichnung des Wirkstoffs bei einer Wirkstoffverordnung	Begründung: § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §1298	Abweichung von der Verordnung bzgl. der Stärke eines Fertigarzneimittels oder Wirkstoffs	Begründung: § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §1299	Abweichung von der Verordnung bzgl. der Zusammensetzung von Rezepturen nach Art und Menge	Begründung: § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §12910	Abweichung von der Verordnung bzgl. der abzugebenden Menge	Begründung: § 6 Abs. 2 Buchst. c Satz 2 Rahmenvertrag §12911	Abweichung von der Verordnung bzgl. der abzugebenden Rezepturmenge auf eine Reichdauer bis zu 7 Tagen bei Entlassverordnung	Begründung: Anlage 8 § 4 Abs. 5 Rahmenvertrag §12912	Freitextliche Dokumentation der Änderung wenn keiner der anderen Schlüssel / Fälle vorliegt	Dokumentation der Änderung im Feld 'Dokumentation Rezeptänderung' erforderlich13	Abweichung von der Verordnung aufgrund von Lieferengpässen ggfls. mit Dosierungsänderungen	Begründung: § 129 Abs. 2a Satz 4 Nr. 1, Nr. 2 und Nr.4 SGB V14	Austausch aufgrund der Dringlichkeitsliste ggfls. mit Dosierungsänderungen	Begründung: § 129 Abs. 2b SGB V                                        </textarea>                                    </div>                                </div>                            </div>                        </xsl:if><!-- Ende Rezeptänderungen -->                    </div>                </div>            </div>            <p align="right">FHIR-Instanzversion:                <b> <xsl:call-template name="getVersion">                    <xsl:with-param name="url" select="//fhir:meta/fhir:profile/@value"/>                </xsl:call-template></b> Stylesheet: <b>v1.0</b>            </p>        </div>        <!-- Bootstrap JS und jQuery -->        <script src="js/bootstrap.bundle.min.js"></script>        <script src="js/popper.min.js"></script>        <script src="js/jquery-3.5.1.slim.min.js"></script>    </xsl:template>    <!-- Templates für Funktionen -->    <xsl:template name="formatDate">        <xsl:param name="date"/>        <xsl:variable name="yearNum" select="substring ($date, 1, 4)"/>        <xsl:variable name="monthNum" select="substring ($date, 6, 2)"/>        <xsl:variable name="dayNum" select="substring ($date, 9, 2)"/>        <xsl:if test="$dayNum!=''">            <xsl:value-of select="$dayNum"/>            <xsl:text>.</xsl:text>        </xsl:if>        <xsl:if test="$dayNum!=''">            <xsl:value-of select="$monthNum"/>            <xsl:text>.</xsl:text>        </xsl:if>        <xsl:value-of select="$yearNum"/>    </xsl:template>    <xsl:template name="formatTime">        <xsl:param name="date"/>        <xsl:value-of select="substring($date, 12, 8)"/> Uhr    </xsl:template>    <xsl:template name="substring-after-last">        <xsl:param name="input"/>        <xsl:param name="substr"/>        <xsl:variable name="lastChar" select="substring($input, string-length($input) - string-length($substr) +1)"/>        <xsl:choose>            <xsl:when test="$lastChar=$substr">                <xsl:call-template name="substring-after-last">                    <xsl:with-param name="input" select="substring($input,1, string-length($input)-1)"/>                    <xsl:with-param name="substr" select="$substr"/>                </xsl:call-template>            </xsl:when>            <xsl:otherwise>                <!-- Extract the string which comes after the first occurence -->                <xsl:variable name="temp" select="substring-after($input,$substr)"/>                <xsl:choose>                    <!-- If it still contains the search string the recursively process -->                    <xsl:when test="$substr and  contains($temp,$substr)">                        <xsl:call-template name="substring-after-last">                            <xsl:with-param name="input" select="$temp"/>                            <xsl:with-param name="substr" select="$substr"/>                        </xsl:call-template>                    </xsl:when>                    <xsl:otherwise>                        <xsl:if test="contains($temp,'/')">                            <xsl:call-template name="substring-after-last">                                <xsl:with-param name="input" select="$temp"/>                                <xsl:with-param name="substr" select="$substr"/>                            </xsl:call-template>                        </xsl:if>                        <xsl:value-of select="$temp"/>                    </xsl:otherwise>                </xsl:choose>            </xsl:otherwise>        </xsl:choose>    </xsl:template>    <xsl:template name="getVersion">        <xsl:param name="url"/>        <xsl:variable name="version" select="substring-after($url,'|')"/>        <xsl:value-of select="$version"/>    </xsl:template>    <xsl:template name="getPossibleEmptyValue">        <xsl:param name="path"/>        <xsl:choose>            <xsl:when test="$path">                <xsl:value-of select="$path"/>                <text>&#160;</text>            </xsl:when>        </xsl:choose>    </xsl:template>    <xsl:template name="getIdFromReference">        <xsl:param name="ref"/>        <xsl:choose>            <xsl:when test="contains($ref,'/')">                <xsl:call-template name="substring-after-last">                    <xsl:with-param name="input" select="$ref"/>                    <xsl:with-param name="substr" select="'/'"/>                </xsl:call-template>            </xsl:when>            <xsl:when test="contains($ref,':')">                <xsl:call-template name="substring-after-last">                    <xsl:with-param name="input" select="$ref"/>                    <xsl:with-param name="substr" select="':'"/>                </xsl:call-template>            </xsl:when>            <xsl:otherwise>                <xsl:value-of select="$ref"/>            </xsl:otherwise>        </xsl:choose>    </xsl:template>    <!-- Zusatzattribute -->    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='1']">  <!-- Markt -->        <!--xsl:template match="fhir:extension[@url='Markt']"-->        <xsl:text disable-output-escaping='yes'>Markt (Grp1) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='0'">nicht betroffen (</xsl:when> <!-- ab Profileversion 1.2 -->            <xsl:when test="$schluessel='1'">Generika (</xsl:when>            <xsl:when test="$schluessel='2'">Solitär (</xsl:when>            <xsl:when test="$schluessel='3'">Mehrfachvertrieb (</xsl:when>            <xsl:when test="$schluessel='4'">aut-idem gesetzt (</xsl:when> <!-- ab Profileversion 1.2 -->            <xsl:when test="$schluessel='5'">Produkt der Substitutionsausschlussliste (</xsl:when> <!-- ab Profileversion 1.2 -->        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='2']">  <!-- Rabattvertragserfuellung -->        <!--xsl:template match="fhir:extension[@url='Rabattvertragserfuellung']"-->        <xsl:text disable-output-escaping='yes'>Rabattvertragserfüllung (Grp2) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='0'">nicht relevant (</xsl:when>            <xsl:when test="$schluessel='1'">ja, abgegeben (</xsl:when>            <xsl:when test="$schluessel='2'">nein, nicht verfügbar (</xsl:when>            <xsl:when test="$schluessel='3'">nein, dringender Fall (</xsl:when>            <xsl:when test="$schluessel='4'">nein, sonstige Bedenken (</xsl:when>        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        </xsl:if>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='3']">  <!-- PreisguenstigesFAM -->        <!--xsl:template match="fhir:extension[@url='PreisguenstigesFAM']"-->        <xsl:text disable-output-escaping='yes'>Preisgünstiges FAM (Grp3) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='0'">nicht relevant (</xsl:when>            <xsl:when test="$schluessel='1'">ja, abgegeben (</xsl:when>            <xsl:when test="$schluessel='2'">nein, nicht verfügbar (</xsl:when>            <xsl:when test="$schluessel='3'">nein, dringender Fall (</xsl:when>            <xsl:when test="$schluessel='4'">nein, sonstige Bedenken (</xsl:when>        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        </xsl:if>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='4']">  <!-- Import-FAM -->        <!--xsl:template match="fhir:extension[@url='Import-FAM']"-->        <xsl:text disable-output-escaping='yes'>Import-FAM (Grp4) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='0'">nicht relevant (</xsl:when>            <xsl:when test="$schluessel='1'">ja, abgegeben (</xsl:when>            <xsl:when test="$schluessel='2'">nein, nicht verfügbar (</xsl:when>            <xsl:when test="$schluessel='3'">nein, dringender Fall (</xsl:when>            <xsl:when test="$schluessel='4'">nein, sonstige Bedenken (</xsl:when>            <xsl:when test="$schluessel='5'">nicht abgegeben (</xsl:when> <!-- ab Profileversion 1.2 -->        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        </xsl:if>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='5']">  <!-- Mehrkostenübernahme -->        <xsl:text disable-output-escaping='yes'>Mehrkostenübernahme (Grp5) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='1'">ja, nach § 129 Abs. 4c SGB V (</xsl:when>            <xsl:when test="$schluessel='2'">ja, nach Rabattvertrag (</xsl:when>        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='6']">  <!-- Wunscharzneimittel -->        <xsl:text disable-output-escaping='yes'>Wunscharzneimittel (Grp6) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueBoolean/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='true'">ja</xsl:when>        </xsl:choose>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='7']">  <!-- Wirkstoffverordnung -->        <xsl:text disable-output-escaping='yes'>Wirkstoffverordnung (Grp7) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueBoolean/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='true'">ja</xsl:when>        </xsl:choose>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='8']">  <!-- Ersatzverordnung -->        <xsl:text disable-output-escaping='yes'>Ersatzverordnung (Grp8) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueBoolean/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='true'">ja</xsl:when>        </xsl:choose>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='9']">	 <!-- künstliche Befruchtung -->        <xsl:text disable-output-escaping='yes'>künstliche Befruchtung (Grp9) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueBoolean/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='true'">ja, Abgabeangaben sind nicht zu beachten</xsl:when>        </xsl:choose>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='10']"> <!-- einzeln importierte Fertigarzneimittel (§ 73 Abs. 3 AMG) -->        <xsl:text disable-output-escaping='yes'>einzeln importierte Fertigarzneimittel (§ 73 Abs. 3 AMG) (Grp10) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueBoolean/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='true'">ja, Abgabeangaben sind nicht zu beachten</xsl:when>        </xsl:choose>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">	<!-- könnte eingespart werden, da Freitextfeld verfplichtend -->            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        </xsl:if>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='11']"> <!-- Abgabe im Notdienst -->        <xsl:text disable-output-escaping='yes'>Abgabe im Notdienst (Grp11) = </xsl:text>        <xsl:if test="fhir:extension[@url='DatumUhrzeit']">            <xsl:text disable-output-escaping='yes'>am </xsl:text>            <xsl:call-template name="formatDate">                <xsl:with-param name="date" select="fhir:extension[@url='DatumUhrzeit']/fhir:valueDateTime/@value"/>            </xsl:call-template>            <xsl:text disable-output-escaping='yes'> um </xsl:text>            <xsl:call-template name="formatTime">                <xsl:with-param name="date" select="fhir:extension[@url='DatumUhrzeit']/fhir:valueDateTime/@value"/>            </xsl:call-template>        </xsl:if>        <!--xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text-->    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='12']"> <!-- Zusätzliche Abgabeangaben -->        <xsl:text disable-output-escaping='yes'>Zusätzliche Abgabeangaben (Grp12) = </xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>        </xsl:if>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='13']"> <!-- Gruppe für Genehmigungen -->        <xsl:text disable-output-escaping='yes'>Gruppe für Genehmigungen (Grp13) = </xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        </xsl:if>        <xsl:if test="fhir:extension[@url='Datum']">            <xsl:text disable-output-escaping='yes'> am </xsl:text>            <xsl:call-template name="formatDate">                <xsl:with-param name="date" select="fhir:extension[@url='Datum']/fhir:valueDate/@value"/>            </xsl:call-template>        </xsl:if>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='14']"> <!-- Gruppe AC/TK -->        <xsl:text disable-output-escaping='yes'>Gruppe AC/TK (Grp14) = </xsl:text>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        <xsl:if test="fhir:extension[@url='Tarifkennzeichen']">            <xsl:text disable-output-escaping='yes'>Tarifkennzeichen:&#160;</xsl:text>            <xsl:value-of select="fhir:extension[@url='Tarifkennzeichen']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>            <!--xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text-->        </xsl:if>        <xsl:if test="fhir:extension[@url='KennzeichenSondertarif']">            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>            <xsl:text disable-output-escaping='yes'>Kennzeichen Sondertarif:&#160;</xsl:text>            <xsl:value-of select="fhir:extension[@url='KennzeichenSondertarif']/fhir:valueString/@value"/>        </xsl:if>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='15']">  <!-- Zuzahlungsstatus -->        <xsl:text disable-output-escaping='yes'>Zuzahlungsstatus (Grp15) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='0'">Nein (gebührenpflichtig) (</xsl:when> <!-- von Zuzahlungspflicht nicht befreit (gebührenpflichtig) -->            <xsl:when test="$schluessel='1'">Ja (gebührenfrei) (</xsl:when> <!-- von Zuzahlungspflicht befreit (gebührenfrei) -->        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='16']"> <!-- Teilmengenabgabe -->        <xsl:text disable-output-escaping='yes'>Teilmengenabgabe (Grp16) = </xsl:text>        <xsl:if test="fhir:extension[@url='Spender-PZN']">            <xsl:text disable-output-escaping='yes'>Spender-PZN:&#160;</xsl:text>            <xsl:value-of select="fhir:extension[@url='Spender-PZN']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        </xsl:if>        <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>    </xsl:template>    <xsl:template match="fhir:extension[fhir:extension[@url='Gruppe']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value='101']"> <!-- Aut idem Austausch -->        <xsl:text disable-output-escaping='yes'>AutidemAustausch (Grp101) = </xsl:text>        <xsl:variable name="schluessel" select="fhir:extension[@url='Schluessel']/fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$schluessel='1'">Patientenwunsch</xsl:when>            <xsl:when test="$schluessel='2'">Nicht-Verfügbarkeit</xsl:when>            <xsl:when test="$schluessel='3'">dringender Fall</xsl:when>            <xsl:when test="$schluessel='4'">sonstige Bedenken</xsl:when>        </xsl:choose>        <xsl:value-of select="($schluessel)"/>        <xsl:text disable-output-escaping='yes'>)&#13;&#10;</xsl:text>        <xsl:if test="fhir:extension[@url='DokumentationFreitext']">            <xsl:value-of select="fhir:extension[@url='DokumentationFreitext']/fhir:valueString/@value"/>            <xsl:text disable-output-escaping='yes'>&#13;&#10;</xsl:text>        </xsl:if>    </xsl:template>    <!-- Templates für Rezeptänderungen -->    <!--xsl:template match="fhir:extension[@url='ArtRezeptaenderung']">        <xsl:variable name="aenderungsart" select="fhir:valueCodeableConcept/fhir:coding/fhir:code/@value"/>        <xsl:choose>            <xsl:when test="$aenderungsart='1'">Abweichung von der Verordnung bzgl. der Darreichungsform bei Fertigarzneimitteln (</xsl:when>            <xsl:when test="$aenderungsart='2'">Korrektur / Ergänzung der Darreichungsform bei Rezepturen (</xsl:when>            <xsl:when test="$aenderungsart='3'">Korrektur / Ergänzung der Gebrauchsanweisung bei einer Rezeptur (</xsl:when>            <xsl:when test="$aenderungsart='4'">Korrektur / Ergänzung der Dosierungsanweisung (</xsl:when>            <xsl:when test="$aenderungsart='5'">Ergänzung eines fehlenden Hinweises auf einen Medikationsplan, der das verschriebene Arzneimittel umfasst, oder auf eine schriftliche Dosierungsanweisung (</xsl:when>            <xsl:when test="$aenderungsart='6'">Abweichung von der Verordnung bzgl. der Bezeichnung des Fertigarzneimittels (</xsl:when>            <xsl:when test="$aenderungsart='7'">Abweichung von der Verordnung bzgl. der Bezeichnung des Wirkstoffs bei einer Wirkstoffverordnung (</xsl:when>            <xsl:when test="$aenderungsart='8'">Abweichung von der Verordnung bzgl. der Stärke eines Fertigarzneimittels oder Wirkstoffs (</xsl:when>            <xsl:when test="$aenderungsart='9'">Abweichung von der Verordnung bzgl. der Zusammensetzung von Rezepturen nach Art und Menge (</xsl:when>            <xsl:when test="$aenderungsart='10'">Abweichung von der Verordnung bzgl. der abzugebenden Menge (</xsl:when>            <xsl:when test="$aenderungsart='11'">Abweichung von der Verordnung bzgl. der abzugebenden Rezepturmenge auf eine Reichdauer bis zu 7 Tagen bei Entlassverordnung (</xsl:when>            <xsl:when test="$aenderungsart='12'">Freitextliche Dokumentation der Änderung wenn keiner der anderen Schlüssel / Fälle vorliegt (</xsl:when>            <xsl:when test="$aenderungsart='13'">Abweichung von der Verordnung aufgrund von Lieferengpässen ggfls. mit Dosierungsänderungen (</xsl:when>            <xsl:when test="$aenderungsart='14'">Austausch aufgrund der Dringlichkeitsliste ggfls. mit Dosierungsänderungen (</xsl:when>        </xsl:choose>        <xsl:value-of select="($aenderungsart)"/>        <xsl:text disable-output-escaping='yes'>)</xsl:text>    </xsl:template-->    <!-- Zusatzdaten Herstellung -->    <xsl:template match="/fhir:Bundle/fhir:entry/fhir:resource/fhir:MedicationDispense" mode="resource">        <div class="row g-0" style="padding-top: 0px !important; margin-top: 0px !important;">            <div class="col-3" style="margin-top:4px;">                <div class="input-container">                    <label>Herstellungsvorgang Nr</label>                    <input type="text" class="text-input" value="{fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Zaehler']/fhir:valuePositiveInt/@value}" readonly=""/>                </div>            </div>            <div class="col-3" style="margin-top:4px;">                <div class="input-container">                    <label>Zeitpunkt</label> <!-- TODO: Ausgabe -->                    <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>                    <xsl:value-of select="fhir:whenPrepared/@value"/>                    <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                    <!--					<xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>					<xsl:call-template name="formatDate">						<xsl:with-param name="date" select="fhir:whenPrepared/@value"/>					</xsl:call-template>-					<xsl:call-template name="formatTime">						<xsl:with-param name="date" select="fhir:whenPrepared/@value"/> <- TODO: Zeitzone >					</xsl:call-template>					<xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>					-->                </div>            </div>            <div class="col-3" style="margin-top:4px;">                <div class="input-container">                    <label>Funktion der abrechnenden Apotheke</label>                    <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input&#34; value=&#34;</xsl:text>                    <xsl:choose>                        <xsl:when test="fhir:performer/fhir:function/fhir:coding/fhir:code/@value='1'">Eigenfertigung (1)</xsl:when>                        <xsl:when test="fhir:performer/fhir:function/fhir:coding/fhir:code/@value='2'">Fremdfertigung (2)</xsl:when>                    </xsl:choose>                    <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                </div>            </div>            <div class="col-3" style="margin-top:4px;">                <div class="input-container">                    <xsl:if test="fhir:performer/fhir:actor/fhir:identifier/fhir:system/@value='http://fhir.de/sid/arge-ik/iknr'">                        <label>ApothekenIK</label>                    </xsl:if>                    <xsl:if test="fhir:performer/fhir:actor/fhir:identifier/fhir:system/@value='http://fhir.abda.de/Identifier/DAV-Herstellerschluessel'">                        <label>DAV-Herstellerschluessel</label>                    </xsl:if>                    <input type="text" class="text-input" value="{fhir:performer/fhir:actor/fhir:identifier/fhir:value/@value}" readonly=""/>                </div>            </div>        </div>        <!-- Start ZusatzdatenEinheiten -->        <h4>Zusatzdaten Einheit(en)</h4>        <xsl:for-each select="fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-ZusatzdatenEinheit']">            <xsl:variable name="id_zdhs" select="fhir:valueReference/fhir:reference/@value"/>            <xsl:apply-templates select="/fhir:Bundle/fhir:entry[fhir:fullUrl/@value=$id_zdhs]/fhir:resource/fhir:Invoice" mode="resource"/>            <!-- ===> mit Zusatzen Einheiten -->        </xsl:for-each>    </xsl:template>    <!-- Zusatzdaten Einheit -->    <xsl:template match="/fhir:Bundle/fhir:entry/fhir:resource/fhir:Invoice" mode="resource">        <xsl:variable name="znr" select="fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Zaehler']/fhir:valuePositiveInt/@value"/>        <xsl:for-each select="fhir:lineItem">            <div class="row g-0" style="padding-top: 0px !important; margin-top: 0px !important;">                <div class="col-1">                    <div class="input-container">                        <label>ZählerEinheit</label>                        <input type="text" class="text-input border-right-left" value="{$znr}" readonly=""/>                    </div>                </div>                <div class="col-1">                    <div class="input-container">                        <label>Pos</label>                        <input type="text" class="text-input border-right-left" value="{fhir:sequence/@value}" readonly=""/>                    </div>                </div>                <div class="col-2" >                    <div class="input-container">                        <label>                            <xsl:variable name="cs" select="fhir:chargeItemCodeableConcept/fhir:coding/fhir:system/@value"/>                            <xsl:choose>                                <xsl:when test="$cs='http://fhir.de/CodeSystem/ifa/pzn'">PZN</xsl:when>                                <xsl:when test="$cs='http://TA1.abda.de'">SKZ</xsl:when>                            </xsl:choose>                        </label>                        <input type="text" class="text-input border-right-left" value="{fhir:chargeItemCodeableConcept/fhir:coding/fhir:code/@value}" readonly=""/>                    </div>                </div>                <div class="col-1">                    <div class="input-container">                        <label>Faktor</label>                        <input type="text" class="text-input border-right-left" value="{fhir:priceComponent/fhir:factor/@value}" readonly=""/>                    </div>                </div>                <div class="col-3">                    <div class="input-container">                        <label>Faktorkennzeichen</label>                        <xsl:variable name="faktorkennzeichen" select="fhir:priceComponent/fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-ZusatzdatenFaktorkennzeichen']/fhir:valueCodeableConcept/fhir:coding[fhir:system/@value='http://fhir.abda.de/eRezeptAbgabedaten/CodeSystem/DAV-CS-ERP-ZusatzdatenEinheitFaktorkennzeichen']/fhir:code/@value"/>                        <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input border-right-left&#34; value=&#34;</xsl:text>                        <xsl:choose>                            <xsl:when test="$faktorkennzeichen='11'">Anteil in Promille (</xsl:when> 					<!-- (Kennzeichen für verarbeitete Packungen oder Teilmengen von Packungen, Stoffen, Gefäßen oder für Zuschläge) -->                            <xsl:when test="$faktorkennzeichen='55'">Einzeldosis in Milligramm (</xsl:when> 			<!-- (Opioidsubstitution Take-Home-Verordnung) -->                            <xsl:when test="$faktorkennzeichen='56'">Einzeldosis in Milligramm (</xsl:when> 			<!-- (Opioidsubstitution Z-Verordnung) -->                            <xsl:when test="$faktorkennzeichen='57'">Einzeldosis in Milligramm (</xsl:when>			<!-- (Opioidsubstitution Sichtvergabe) -->                            <!-- (Kennzeichen für verarbeitete Packungen oder Teilmengen von Packungen, Stoffen, Gefäßen oder für Zuschläge) -->                            <xsl:when test="$faktorkennzeichen='99'">Anteil einer Packung in Promille (Verwurf) (</xsl:when>                        </xsl:choose>                        <xsl:value-of select="($faktorkennzeichen)"/>                        <xsl:text disable-output-escaping='yes'>)&#34; readonly/&gt;</xsl:text>                    </div>                </div>                <div class="col-2">                    <div class="input-container">                        <label>Netto Preis AbgPos</label>                        <xsl:text disable-output-escaping='yes'>&lt;input type=&#34;text&#34; class=&#34;text-input border-right-left&#34; value=&#34;</xsl:text>                        <xsl:value-of select="translate(fhir:priceComponent/fhir:amount/fhir:value/@value, '.', ',')"/>                        <xsl:text disable-output-escaping='yes'> </xsl:text>                        <xsl:value-of select="fhir:priceComponent/fhir:amount/fhir:currency/@value"/>                        <xsl:text disable-output-escaping='yes'>&#34; readonly/&gt;</xsl:text>                    </div>                </div>                <div class="col-2">                    <div class="input-container">                        <label>Preiskennzeichen</label>                        <input type="text" class="text-input" value="{fhir:priceComponent/fhir:extension/fhir:valueCodeableConcept/fhir:coding[fhir:system/@value='http://fhir.abda.de/eRezeptAbgabedaten/CodeSystem/DAV-CS-ERP-ZusatzdatenEinheitPreiskennzeichen']/fhir:code/@value}" readonly=""/>                    </div>                </div>            </div>            <xsl:if test="(fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Chargenbezeichnung'])">                <div class="row g-0" style="padding-top: 0px !important; margin-top: -10px !important;">                    <div class="col-12 margin-top-min-1">                        <div class="input-container">                            <label>Chargennummer(n)</label>                            <textarea type="text" class="text-input height-18mm border-dotted-t-l">                                <xsl:for-each select="fhir:extension[@url='http://fhir.abda.de/eRezeptAbgabedaten/StructureDefinition/DAV-EX-ERP-Chargenbezeichnung']">                                    <xsl:value-of select="fhir:valueString/@value"/>                                </xsl:for-each>                            </textarea>                        </div>                    </div>                </div>            </xsl:if>        </xsl:for-each> <!-- lineItem -->    </xsl:template></xsl:stylesheet>